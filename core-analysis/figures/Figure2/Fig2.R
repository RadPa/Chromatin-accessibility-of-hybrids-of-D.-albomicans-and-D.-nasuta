res <- read.table("nfr.tes.des.txt", header=T, sep="\t")
len <- read.table("nfr.tes.des.len.bed", header=F, sep="\t")
res$col <- rownames(res)
res$col <- gsub("NC_047627.1.*", "#cc0000ff", res$col)
res$col <- gsub("NC_047628.1.*", "#e25ed9ff", res$col)
res$col <- gsub("NC_047629.1.*", "turquoise", res$col)
res$col <- gsub("NC_047630.1.*", "#ff9900ff", res$col)
res$col <- gsub("NC_047631.1.*", "#cae00d", res$col)
res$col <- gsub("NW_022995738.1.*", "tan", res$col)
res$col <- gsub("NW_022995739.1.*", "mistyrose3", res$col)
res$col <- gsub("NW_022995740.1.*", "tan", res$col)
res$col <- gsub("NW_022995741.1.*", "tan", res$col)
res$col <- gsub("NW_022995742.1.*", "tan", res$col)

colnames(len) <- "len"
res <- cbind(res, len)

res.x <- subset(res, col=="#cc0000ff")
jpeg("vol.x.jpeg", height = 4, width = 4, units= 'in', res = 1200, pointsize = 12)
par(cex.axis=0.8, cex.lab=1)
plot(-log10(pvalue) ~ log2FoldChange, pch=20, col=col, cex= ifelse(padj<=0.1,len/10000,0.1), xlim= c(-2,2), ylim=c(0,7), res.x)
#text(-log10(res.x$pvalue) ~ res.x$log2FoldChange, labels=res.x$lab, cex= 0.7, pos=3, offset = 0.5)
dev.off()

res.2l <- subset(res, col=="#e25ed9ff")
jpeg("vol.2l.jpeg", height = 4, width = 4, units= 'in', res = 1200, pointsize = 12)
par(cex.axis=0.8, cex.lab=1)
plot(-log10(pvalue) ~ log2FoldChange, pch=20, col="#e25ed9ff", cex= ifelse(padj<=0.1,len/10000,0.1), xlim= c(-1,1), ylim=c(0,7), res.2l)
#text(-log10(res.2l$pvalue) ~ res.2l$log2FoldChange, labels=res.2l$lab, cex= 0.7, pos=3, offset = 0.5)
dev.off()

res.3 <- subset(res, col=="turquoise")
jpeg("vol.3.jpeg", height = 4, width = 4, units= 'in', res = 1200, pointsize = 12)
par(cex.axis=0.8, cex.lab=1)
plot(-log10(pvalue) ~ log2FoldChange, pch=20, col=col, cex= ifelse(padj<=0.1,len/10000,0.1), xlim= c(-1.5,1.5), ylim=c(0,7), res.3)
#text(-log10(res.3$pvalue) ~ res.3$log2FoldChange, labels=res.3$lab, cex= 0.7, pos=3, offset = 0.5)
#text(-log10(res.3$pvalue) ~ res.3$log2FoldChange, labels=ifelse(res.3$lab=="ankyrin-3"| res.3$lab== "BRSK1", "", res.3$lab), cex= 0.7, pos=3, offset = 0.5)
dev.off()

res.4 <- subset(res, col=="#ff9900ff")
jpeg("vol.4.jpeg", height = 4, width = 4, units= 'in', res = 1200, pointsize = 12)
par(cex.axis=0.8, cex.lab=1)
plot(-log10(pvalue) ~ log2FoldChange, pch=20, col=col, cex= ifelse(padj<=0.01, len/10000, 0.1), xlim= c(-1.4,1), ylim=c(0,12), res.4)
#text(-log10(res.4$pvalue) ~ res.4$log2FoldChange, labels=res.4$lab, cex= 0.7, pos=3, offset = 0.5)
dev.off()

res.2r <- subset(res, col=="#cae00d")
jpeg("vol.2r.jpeg", height = 4, width = 4, units= 'in', res = 1200, pointsize = 12)
par(cex.axis=0.8, cex.lab=1)
plot(-log10(pvalue) ~ log2FoldChange, pch=20, col="#3fff00", cex= ifelse(padj<=0.1, len/10000, 0.1), xlim= c(-1.5,1.5), ylim=c(0,7), res.2r)
#text(-log10(res.2r$pvalue) ~ res.2r$log2FoldChange, labels=res.2r$lab, cex= 0.7, pos=3, offset = 0.5)
dev.off()

res.u <- subset(res, col=="tan" | col=="mistyrose3")
jpeg("vol.u.jpeg", height = 4, width = 4, units= 'in', res = 1200, pointsize = 12)
par(cex.axis=0.8, cex.lab=1)
plot(-log10(pvalue) ~ log2FoldChange, pch=20, col=col, cex= ifelse(padj<=0.1, len/10000, 0.1), xlim= c(-4.5,1), ylim=c(0,30), res.u)
#text(-log10(res.u$pvalue) ~ res.u$log2FoldChange, labels=res.u$lab, cex= 0.7, pos=3, offset = 0.5)
dev.off()
